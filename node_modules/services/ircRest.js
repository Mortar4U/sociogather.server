var IRC = require("services/irc");


function ircRest(app) {
  var irc = new IRC();

  app.post("/irc/connect", function(req, res) {
    irc.connect(req.body)
      .done(function(connection) {
        res.send({cid: connection.cid});
      });
  });


  app.post("/irc/disconnect/:cid", function(req, res) {
    irc.disconnect(req.params.cid)
      .done(function() {
        res.send();
      });
  });


  app.post("/irc/join/:cid", function(req, res) {
    irc.join(req.params.cid, req.body)
      .done(function(channels) {
        res.send(channels);
      });
  });


  app.post("/irc/leave/:cid", function(req, res) {
    irc.leave(req.params.cid, req.body)
      .done(function(message) {
        res.send(message);
      });
  });


  app.post("/irc/message/:cid", function(req, res) {
    irc.sendMessage(req.params.cid, req.body)
      .done(function(message) {
        res.send(message);
      });
  });


  app.get("/irc/message/:cid/:id", function(req, res) {
    irc.getMessage(req.params.cid, req.params.id)
      .done(function(message) {
        res.send(message);
      })
      .fail(function() {
        res.send(404, "Not found");
      });
  });


  app.put("/irc/message/:cid", function(req, res) {
    irc.updateMessage(req.params.cid, req.body)
      .done(function(message) {
        res.send(message);
      })
      .fail(function() {
        res.send(404, "Not found");
      });
  });


  app.delete("/irc/message/:cid", function(req, res) {
    irc.deleteMessage(req.params.cid, req.body)
      .done(function(message) {
        res.send(message);
      })
      .fail(function() {
        res.send(404, "Not found");
      });
  });


  app.get("/irc/messages/:cid", function(req, res) {
    irc.getAllMessages(req.params.cid, req.query)
      .done(function(messages) {
        res.send(messages);
      });
  });


  app.delete("/irc/messages", function(req, res) {
    res.send(200, "I told you not to call this interface!");
  });

}


module.exports = ircRest;

